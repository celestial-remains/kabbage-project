{% extends "/base.html" %}
{% block title %}Index{% endblock %}
{% block head %}
  {{ super() }}
  <script type="text/javascript">

       // Declare and Configure app
       var app = angular.module('searchApp', []);
       app.config(['$interpolateProvider', function($interpolateProvider) {
        $interpolateProvider.startSymbol('{[');
        $interpolateProvider.endSymbol(']}');
       }]);

      // Define functionality of app
       app.controller('myCtrl', function($scope,$http) {
          $scope.sendPost = function() {
              console.log("search_term" + $scope.search_term);
              $http.post("/", {text:$scope.search_term}).then(function(response){
                 console.log(response.data);
                 $scope.stati = response.data.stati;
                 $scope.error_message = response.data.error_message;
               });
           };//end find
        });//end controller

  </script>
{% endblock %}


{% block content %}

  <!-- Implementation of Search App -->
<div ng-app="searchApp" ng-controller="myCtrl">

  <!-- Search Section -->
  <section>
   <div class="jumbotron clearfix">

      <!-- Site Info -->
      <div class="col-lg-4">
        <h2>{{site_name}}</h2>
        <h4>{{site_description}}</h4>
          <h6 ng-if="error_message" class="warning"><span class="glyphicon glyphicon-alert"></span> {[error_message]}</h6>
      </div><!-- /.col-lg-6 -->

      <!-- Prompt Graphics -->
      <div class="col-lg-2 prompt">
        <h3 class="pull-left">Enter a Topic!</h3>
        <span class="pull-right blink">
          <span class="glyphicon glyphicon-chevron-right"></span>
          <span class="glyphicon glyphicon-chevron-right"></span>
          <span class="glyphicon glyphicon-chevron-right"></span>
        </span>
      </div>

      <!--  Search Bar -->
      <div class="col-lg-6 ">
          <div class="input-group">
            <input type="text" class="form-control " ng-model="search_term"
              ng-minlength="1" placeholder="Search for..."> 
            <span class="input-group-btn">
              <button class="btn btn-default" type="button" 
                ng-click="sendPost()">Go!</button>
            </span>
          </div><!-- /input-group -->
      </div><!-- /.col-lg-6 -->
    </div><!-- /.jumbotron -->
  </section>

  <!-- Query Results Section -->
  <section>
    <div class="col-lg-6">
      <div class="panel panel-default" ng-if="stati" ng-repeat="stat in stati">
        {[ stat ]}
      </div>
    </div><!-- /.col-lg-6 -->
  </section>

</div><!-- /ng-app -->
{% endblock %}
